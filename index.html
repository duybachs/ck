<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stock Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .chart-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; width: 100%; }
        .sector-container { display: flex; flex-wrap: wrap; gap: 1rem; }
        .sector-list { flex: 1 1 60px; min-width: 20px; }
        .stock-item { display: flex; align-items: center; padding: 0.5rem; }
        .stock-item span { min-width: 3rem; }
        @media (max-width: 1024px) { .chart-grid { grid-template-columns: repeat(2, 1fr); } }
        @media (max-width: 640px) { 
            .chart-grid { grid-template-columns: 1fr; }
            .sector-list { min-width: 100%; }
            .stock-item span { font-size: 0.875rem; }
        }
    </style>
</head>
<body class="bg-gray-100 font-sans">
    <div class="w-full min-h-screen flex flex-col p-4">
        <h1 class="text-2xl font-bold text-gray-800 mb-4">Stock Dashboard</h1>
        
        <!-- Controls -->
        <div class="bg-white p-4 rounded-lg shadow mb-6">
            <div class="flex flex-wrap gap-4 items-center">
                <button onclick="window.open('comm.html', '_blank')" class="bg-green-500 text-white px-3 py-1 rounded hover:bg-green-600 text-sm">Commodities</button>
            </div>
        </div>

        <!-- Stock Lists by Sector -->
        <div class="bg-white p-4 rounded-lg shadow mb-6">
            <h2 class="text-lg font-semibold text-gray-700 mb-2">Stock Lists by Sector</h2>
            <div id="sectorContainer" class="sector-container"></div>
        </div>

        <!-- Chart Container -->
        <div id="chartContainer" class="chart-grid flex-1"></div>
    </div>

    <script>
        // Danh sách cổ phiếu đầy đủ từ mã gốc
        const defaultStocksBySector = {
            "Ngân hàng": [
                "TCB", "MBB", "SHB", "STB", "HDB", "ACB", "EIB", "MSB",
                "TPB", "LPB", "OCB", "VCB", "BID", "CTG", "VIB", "VPB", "SSB", "EVF"
            ],
            "Chứng khoán": [
                "VND", "VIX", "VCI", "SSI", "HCM", "FTS", "SHS", "MBS",
                "BSI", "ORS", "VDS", "CTS", "AGR", "APG", "SBS", "APS"
            ],
            "Công nghệ": [
                "FPT", "CMG", "ELC", "FOX", "VGI", "MFS", "ST8", "TTN"
            ],
            "Hóa chất - phân bón": [
                "DGC", "DDV", "DCM", "DPM", "CSV", "LIX", "BFC"
            ],
            "Mía đường - cao su": [
                "GVR", "DRI", "DPR", "DRC", "PHR", "SBT", "QNS", "LSS"
            ],
            "Logistic - Vận tải - Cảng biển": [
                "VSC", "HAH", "SWC", "GMD", "VTP", "ACV", "VOS", "PHP",
                "SGP", "TCL", "DXP", "SKG", "VTO"
            ],
            "Chuỗi bán lẻ": [
                "MWG", "MSN", "VNM", "FRT", "DGW", "CTF", "HAX", "KDC", "PNJ"
            ],
            "Dược - Bệnh viện": [
                "JVC", "DHG", "DHT", "IMP", "DBD", "TNH", "VNB", "MSR", "DCL", "YEG"
            ],
            "Thép - nhựa": [
                "HPG", "HSG", "NKG", "SMC", "VGS", "TLH", "TVN", "BMP",
                "NTP", "PGN", "VTZ", "AAA", "NHH"
            ],
            "Cho thuê KCN, văn phòng": [
                "LHG", "VRE", "KBC", "VGC", "DTD", "BCM", "SZC", "IDC",
                "SIP", "NTC", "KSB", "VCG", "SGT"
            ],
            "Phát điện": [
                "GEG", "TV2", "POW", "REE", "HDG", "NT2", "TTA", "PPC", "QTP", "BGE"
            ],
            "Thi công, thiết bị điện - cấp nước": [
                "GEE", "GEX", "PC1", "SAM", "VPG", "NED", "BWE", "TDM"
            ],
            "Xây dựng, kinh doanh BĐS": [
                "KDH", "NLG", "HDC", "VIC", "VHM", "NVL", "DXG", "TCH",
                "HHS", "PDR", "DIG", "VPI", "NTL", "CEO", "HQC", "QCG",
                "NBB", "DC4", "BCG", "NHA"
            ],
            "Thi công, xây lắp - vật liệu": [
                "DPG", "G36", "CII", "HHV", "CTD", "HBC", "LCG", "FCN",
                "C4G", "ACC", "BCC", "DHA", "CTI", "HUT", "CTR"
            ],
            "Sản xuất - xuất khẩu thực phẩm": [
                "VHC", "IDI", "CMX", "ANV", "PAN", "FMC", "MPC", "BAF",
                "MML", "DBC", "HAG", "HNG", "MCH", "MCM", "TSC", "OCH",
                "SAB", "NAF"
            ],
            "Sản xuất hàng tiêu dùng": [
                "TCM", "TNG", "MSH", "PTB", "TTF", "VCS", "VLC", "HNM",
                "AGM", "VHE", "TLG", "CLX", "DHC", "HAP", "CSM", "SHI",
                "VGT", "GIL", "VEA", "NET"
            ],
            ".......": [],
            "Du lịch - Hàng không - Bảo hiểm": [
                "HVN", "VJC", "VTR", "TCO", "BVH", "BMI", "MIG", "VTD"
            ],
            "---": [
                "Phân bón", "Chứng khoán", "Bất động sản"
            ],
            "Khai thác, lọc hóa dầu": [
                "PVT", "PVS", "PVD", "BSR", "PVB", "PLX", "GAS", "PVC", "OIL", "PLC"
            ]
        };

        let stocksBySector = defaultStocksBySector;

        // Hiển thị danh sách cổ phiếu theo sector
        function renderStockLists() {
            const container = document.getElementById('sectorContainer');
            container.innerHTML = '';
            Object.keys(stocksBySector).forEach(sector => {
                const stocks = stocksBySector[sector] || [];
                const sectorDiv = document.createElement('div');
                sectorDiv.className = 'sector-list p-3 rounded border border-gray-200';
                sectorDiv.innerHTML = `
                    <h3 class="text-blue-600 font-semibold mb-2">${sector}</h3>
                    <div class="stock-list space-y-1" data-sector="${sector}">
                        ${stocks.map(item => `
                            <div class="stock-item rounded border border-gray-200">
                                <span class="inline-block">${item}</span>
                            </div>
                        `).join('')}
                    </div>
                    <div class="mt-2">
                        <button onclick="showSectorCharts('${sector}')" class="bg-gray-200 text-gray-800 px-3 py-1 rounded hover:bg-purple-600 hover:text-white text-sm">Show Charts</button>
                    </div>
                `;
                container.appendChild(sectorDiv);
            });
        }

        // Hiển thị biểu đồ cho sector
        function showSectorCharts(sector) {
            const chartContainer = document.getElementById('chartContainer');
            chartContainer.innerHTML = '';
            renderGraph('VNINDEX', 'D', `https://stockchart.vietstock.vn/?stockcode=VNINDEX&lang=vi&isIframe=1`, `frame-chart_VNINDEX`);
            (stocksBySector[sector] || []).forEach(item => {
                if (item.length === 3 || item === 'VNINDEX') {
                    renderGraph(item, 'D', `https://stockchart.vietstock.vn/?stockcode=${item}&lang=vi&isIframe=1`, `frame-chart_${item}`);
                }
            });
        }

        // Tạo iframe cho biểu đồ
        function renderGraph(name, interval, src, id) {
            const iframe = document.createElement('iframe');
            iframe.id = id;
            iframe.src = src;
            iframe.className = 'w-full h-[300px] border border-gray-200 rounded';
            iframe.dataset.stock = name;
            document.getElementById('chartContainer').appendChild(iframe);
        }

        // Khởi tạo danh sách cổ phiếu
        renderStockLists();
    </script>
</body>
</html>
